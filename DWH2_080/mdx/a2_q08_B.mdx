%%mdx
-- 8. For 2024, show Avg Data Quality by Country, but only for countries whose 2024 year-total
-- Devices Reporting is at least 2000. Return Countries on rows (filtered to Devices Reporting â‰¥
-- 2000) and one column with Avg Data Quality for the year 2024.

WITH
  MEMBER [Measures].[Avg Data Quality 2024] AS
    ( [Measures].[Avg Data Quality],
      [dim_timemonth].[Time].[year_num].&[2024] )

SELECT
  { [Measures].[Avg Data Quality 2024] } ON COLUMNS,

  NON EMPTY
  FILTER(
    [dim_city].[Geo].[country_name].Members,
    ( [Measures].[Devices Reporting],
      [dim_timemonth].[Time].[year_num].&[2024] ) >= 2000
  ) ON ROWS

FROM [AirQ Cube]
